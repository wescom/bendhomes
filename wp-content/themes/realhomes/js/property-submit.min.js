jQuery(document).ready(function(e){"use strict";function t(){e(".remove-detail").click(function(t){t.preventDefault();var i=e(this);i.closest(".inspiry-detail").remove()})}if("undefined"!=typeof propertySubmit){var i=function(e){if(e.indexOf("?")>=0){var t=e.split("?");return t[0]}return e},a=i(propertySubmit.ajaxURL),n=propertySubmit.uploadNonce,r=propertySubmit.fileTypeTitle;e("#gallery-thumbs-container").sortable({revert:100,placeholder:"sortable-placeholder",cursor:"move"});var o={browse_button:"select-images",file_data_name:"inspiry_upload_file",drop_element:"drag-and-drop",url:a+"?action=ajax_img_upload&nonce="+n,filters:{mime_types:[{title:r,extensions:"jpg,jpeg,gif,png"}],max_file_size:"10000kb",prevent_duplicates:!0}},s=new plupload.Uploader(o);s.init(),e("#select-images").click(function(e){e.preventDefault(),e.stopPropagation(),s.start()}),s.bind("FilesAdded",function(e,t){var i="";plupload.each(t,function(e){i+='<div id="holder-'+e.id+'" class="gallery-thumb"></div>'}),document.getElementById("gallery-thumbs-container").innerHTML+=i,e.refresh(),s.start()}),s.bind("UploadProgress",function(e,t){document.getElementById("holder-"+t.id).innerHTML="<span>"+t.percent+"%</span>"}),s.bind("Error",function(e,t){document.getElementById("errors-log").innerHTML+="<br/>Error #"+t.code+": "+t.message}),s.bind("FileUploaded",function(t,i,a){var n=e.parseJSON(a.response);if(n.success){var r='<img src="'+n.url+'" alt="" /><a class="remove-image" data-property-id="0"  data-attachment-id="'+n.attachment_id+'" href="#remove-image" ><i class="fa fa-trash-o"></i></a><a class="mark-featured" data-property-id="0"  data-attachment-id="'+n.attachment_id+'" href="#mark-featured" ><i class="fa fa-star-o"></i></a><input type="hidden" class="gallery-image-id" name="gallery_image_ids[]" value="'+n.attachment_id+'"/><span class="loader"><i class="fa fa-spinner fa-spin"></i></span>';document.getElementById("holder-"+i.id).innerHTML=r,l()}else console.log(n)});var l=function(){e("a.remove-image").unbind("click"),e("a.mark-featured").unbind("click"),e("a.mark-featured").click(function(t){t.preventDefault();var i=e(this),a=i.find("i");if(a.hasClass("fa-star-o")){e(".gallery-thumb .featured-img-id").remove(),e(".gallery-thumb .mark-featured i").removeClass("fa-star").addClass("fa-star-o");var i=e(this),n=i.siblings(".gallery-image-id"),r=n.clone().removeClass("gallery-image-id").addClass("featured-img-id").attr("name","featured_image_id");i.closest(".gallery-thumb").append(r),a.removeClass("fa-star-o").addClass("fa-star")}}),e("a.remove-image").click(function(t){t.preventDefault();var i=e(this),r=i.closest(".gallery-thumb"),o=i.siblings(".loader");o.show();var s=e.ajax({url:a,type:"POST",data:{property_id:i.data("property-id"),attachment_id:i.data("attachment-id"),action:"remove_gallery_image",nonce:n},dataType:"html"});s.done(function(t){var i=e.parseJSON(t);i.attachment_removed?r.remove():document.getElementById("errors-log").innerHTML+="<br/>Error : Failed to remove attachment"}),s.fail(function(e,t){alert("Request failed: "+t)})})};l()}var d={};(function(){var t=this;this.container=null,this.canvas=null,this.latlng=null,this.map=null,this.marker=null,this.geocoder=null,this.init=function(e){this.container=e,this.canvas=e.find(".map-canvas"),this.initLatLng(53.346881,-6.25886),this.initMap(),this.initMarker(),this.initGeocoder(),this.initMarkerPosition(),this.initListeners(),this.initAutoComplete(),this.bindHandlers()},this.initLatLng=function(e,t){this.latlng=new window.google.maps.LatLng(e,t)},this.initMap=function(){this.map=new window.google.maps.Map(this.canvas[0],{zoom:8,center:this.latlng,streetViewControl:0,mapTypeId:window.google.maps.MapTypeId.ROADMAP})},this.initMarker=function(){this.marker=new window.google.maps.Marker({position:this.latlng,map:this.map,draggable:!0})},this.initMarkerPosition=function(){var e,t,i=this.container.find(".map-coordinate").val(),a=this.container.find(".goto-address-button").val();i?(e=i.split(","),this.marker.setPosition(new window.google.maps.LatLng(e[0],e[1])),t=e.length>2?parseInt(e[2],10):15,this.map.setCenter(this.marker.position),this.map.setZoom(t)):a&&this.geocodeAddress(a)},this.initGeocoder=function(){this.geocoder=new window.google.maps.Geocoder},this.initListeners=function(){var e=t;window.google.maps.event.addListener(this.map,"click",function(t){e.marker.setPosition(t.latLng),e.updatePositionInput(t.latLng)}),window.google.maps.event.addListener(this.marker,"drag",function(t){e.updatePositionInput(t.latLng)})},this.updatePositionInput=function(e){this.container.find(".map-coordinate").val(e.lat()+","+e.lng())},this.geocodeAddress=function(e){var i,a="",n=e.split(",");for(i=0;i<n.length;i++)a+=jQuery("#"+n[i]).val(),i+1<n.length&&(a+=", ");a=a.replace(/\n/g,","),a=a.replace(/,,/g,",");var r=t;this.geocoder.geocode({address:a},function(e,t){t==window.google.maps.GeocoderStatus.OK&&(r.updatePositionInput(e[0].geometry.location),r.marker.setPosition(e[0].geometry.location),r.map.setCenter(r.marker.position),r.map.setZoom(15))})},this.initAutoComplete=function(){var i=this.container.find(".goto-address-button").val();if(!i)return null;var a=t;e("#"+i).autocomplete({source:function(t,i){a.geocoder.geocode({address:t.term},function(t,a){i(e.map(t,function(e){return{label:e.formatted_address,value:e.formatted_address,latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()}}))})},select:function(e,t){a.container.find(".map-coordinate").val(t.item.latitude+","+t.item.longitude);var i=new window.google.maps.LatLng(t.item.latitude,t.item.longitude);a.map.setCenter(i),setTimeout(function(){a.marker.setValues({position:i,animation:window.google.maps.Animation.DROP})},1500)}})},this.bindHandlers=function(){var i=t;this.container.find(".goto-address-button").bind("click",function(){i.onFindAddressClick(e(this))})},this.onFindAddressClick=function(e){var t=e;this.geocodeAddress(t.val())}}).apply(d),e(".map-wrapper").each(function(){d.init(e(this))}),jQuery().validate&&e("#submit-property-form").validate({rules:{bedrooms:{number:!0},bathrooms:{number:!0},garages:{number:!0},price:{number:!0},size:{number:!0}}}),e("#inspiry-additional-details-container").sortable({revert:100,placeholder:"detail-placeholder",handle:".sort-detail",cursor:"move"}),e(".add-detail").click(function(i){i.preventDefault();var a='<div class="inspiry-detail inputs clearfix"><div class="inspiry-detail-control"><span class="sort-detail fa fa-bars"></span></div><div class="inspiry-detail-title"><input type="text" name="detail-titles[]" /></div><div class="inspiry-detail-value"><input type="text" name="detail-values[]" /></div><div class="inspiry-detail-control"><a class="remove-detail" href="#"><span class="fa fa-times"></span></a></div></div>';e("#inspiry-additional-details-container").append(a),t()}),t();var c=function(){for(var e,t=3,i=document.createElement("div"),a=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",a[0];);return t>4?t:e}();9>=c&&e("#submit-property-form").before('<div class="ie9-message"><i class="fa fa-info-circle"></i>&nbsp; <strong>Current browser is not fully supported:</strong> Please update your browser or use a different one to enjoy all features on this page. </div>')});